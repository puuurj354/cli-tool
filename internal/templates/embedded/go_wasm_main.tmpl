package main

import (
	"fmt"
	"syscall/js"
)

func main() {
	c := make(chan struct{}, 0)

	fmt.Println("Hello from Go WebAssembly!")

	// Register a function to be called from JS
	js.Global().Set("add", js.FuncOf(add))
	js.Global().Set("updateDOM", js.FuncOf(updateDOM))

	// Keep the program running
	<-c
}

// add is a simple example export
func add(this js.Value, args []js.Value) interface{} {
	if len(args) != 2 {
		return "Invalid no of arguments passed"
	}
	a := args[0].Int()
	b := args[1].Int()
	return a + b
}

// updateDOM interacts with the DOM
func updateDOM(this js.Value, args []js.Value) interface{} {
	doc := js.Global().Get("document")
	body := doc.Get("body")
	div := doc.Call("createElement", "div")
	div.Set("innerText", "This element was created by Go WASM!")
	div.Get("style").Set("color", "blue")
	div.Get("style").Set("margin-top", "20px")
	body.Call("appendChild", div)
	return nil
}
